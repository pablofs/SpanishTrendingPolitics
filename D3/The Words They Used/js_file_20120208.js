var data = {};

(function() {

data.parties = [{name: "democrat", speeches: ["\nJOSÉ LUIS CENTELLA GÓMEZ: QUÉ REFORMA LABORAL ESTÁ PREPARANDO EL GOBIERNO QUE USTED MISMO CREE QUE MERECE UNA HUELGA GENERAL\nJOSÉ LUIS CENTELLA GÓMEZ:  Señor presidente del Gobierno ¿qué reforma\nJOSÉ LUIS CENTELLA GÓMEZ:  Señor presidente del Gobierno ¿qué reforma laboral piensa presentar a este Parlamento que usted mismo cree que merece una huelga general?\nJOSÉ LUIS CENTELLA GÓMEZ:  Señor presidente, seguimos sin saber qué es lo\nJOSÉ LUIS CENTELLA GÓMEZ:  Señor presidente, seguimos sin saber qué es lo que va a proponer. Lo que le hemos escuchado es pedirle a los españoles y a las españolas que tengan paciencia, que esperen. Usted podrá esperar, la banca podrá esperar pero los más de 5 millones de parados no pueden esperar, los cientos de miles de personas que son desalojadas de sus viviendas, no pueden esperar, por tanto, usted hoy aquí no puede pedir paciencia a los españoles que están en el desempleo. Usted hoy aquí tiene que traer propuestas para crear empleo aquí y ahora. Por eso creemos que la reforma laboral no va a crear empleo aquí y ahora. La reforma laboral va a abaratar el despido, lo que creará más parados, y va a ser más fácil y más flexible el despido, por tanto, lo que va a hacer es cambiar empleo estable por empleo precario. Lo que hace falta es una reforma del modelo productivo; lo que hace falta es afrontar la creación de empleo. Usted podrá traer aquí una reforma laboral que apruebe con su mayoría absoluta -por cierto, mayoría absoluta que no le han dado los votos sino una ley electoral tramposa-, pero con eso lo único que conseguirá... (Protestas y rumores.) Sí, señorías, ustedes tienen 26 escaños regalados por la Ley Electoral y se lo recordaremos hasta el final de legislatura. Ustedes podrán aprobar una reforma laboral, pero usted no podrá evitar que la gente responda en la calle; usted no podrá evitar que la gente salga a la calle reclamando sus derechos. Y ahí estaremos también nosotros, en la calle con la gente y oponiéndonos a su reforma laboral que va a hacer más débil y todavía más dependiente a nuestra economía. Muchas gracias.",
"\nJOSEP ANTONI DURAN I LLEIDA: CUÁNDO PIENSA CUMPLIR EL GOBIERNO, PUNTUALMENTE, LOS COMPROMISOS DE DEVOLUCIÓN DEL IVA QUE CORRESPONDA A LAS EMPRESAS EXPORTADORAS\nJOSEP ANTONI DURAN I LLEIDA:  Muchas gracias, señor presidente.\nJOSEP ANTONI DURAN I LLEIDA:  Muchas gracias, señor presidente. Señor presidente del Gobierno, a lo largo de esta mañana hemos estado comentando la necesidad de reformas en el ámbito de nuestra economía; algunas reformas profundas como la que acaba de ser objeto de la anterior pregunta, otras difíciles -profundas también- en el ámbito financiero, pero también necesitan cosas mucho más sencillas, cosas que no se podrán hacer quizá en media hora pero sí en pocos días. En este sentido le pregunto, señor presidente, ¿cuándo piensa el Gobierno cumplir, puntualmente, los compromisos de devolución de IVA que corresponden a las empresas exportadoras?\nJOSEP ANTONI DURAN I LLEIDA:  Muchas gracias, señor presidente.\nJOSEP ANTONI DURAN I LLEIDA:  Muchas gracias, señor presidente. No estoy de acuerdo con la respuesta que me da a partir de los datos que le ofrece a usted la Agencia Tributaria. De hecho, ustedes mismos cuando eran oposición planteaban en interpelaciones, preguntas o iniciativas legislativas la misma duda que hoy estoy planteándole en esta pregunta en esta sesión de control. Yo lo que le pido, en primer lugar, es que se cumpla, que se cumpla puntualmente y, además, que los plazos que se determinen sean exactamente los que se correspondan en la práctica -y no en teoría, como los que me acaba de leer- y, por otro lado, que no se pongan trabas innecesarias, porque a veces se hacen inspecciones simplemente para retener el pago del IVA. Le voy a poner ejemplos concretos. La semana pasada recibí un correo electrónico de un pequeño y mediano empresario que decía: La nuestra es una pequeña empresa exportadora con un esfuerzo descomunal y no paran de masacrarnos con pequeñas inspecciones que no acaban en nada, reteniéndonos cantidades que son vitales para poder pagar a la gente. Además, mientras preparas fotocopias de listas interminables de papeles, no nos podemos dedicar a lo que de verdad importa. Así no vamos a ningún lado. Es muy frustrante. Nos tienen retenida la devolución de 32.500 euros. Le voy a exponer otros casos concretos que la propia sectorial de una agrupación de pymes nos hace llegar. Empresa uno: exporta un 50 por ciento de su total de ventas; en los últimos dos años ha sufrido demoras de entre tres y seis meses -tres y seis meses- por un valor total de 4 millones de euros. Empresa dos: embutidos; exporta un 50 por ciento de las ventas; dos meses de demora, cuatro meses de demora; valor de lo retenido, 200.000 euros. Empresa tres: exportación del 50 por ciento del total de ventas; sufrieron una demora de nueve meses por un valor de un millón de euros. Es evidente -usted lo dijo esta mañana en su intervención- que la exportación es uno de los sectores que permite sacar adelante la situación económica. Es evidente también que hay que ayudar a las empresas exportadoras y no se está haciendo, señor presidente. Revise y dígale a la Agencia Tributaria que no ocurre exactamente lo que le dicen sus informes. La práctica es muy distinta a la teoría que explica en su papelito correspondiente. Muchas gracias, señor presidente.",
"\nALFREDO PÉREZ RUBALCABA: CONSIDERA QUE TIENE UN PROGRAMA DE GOBIERNO A LA ALTURA DE LAS NECESIDADES DE ESPAÑA\nALFREDO PÉREZ RUBALCABA:  Muchas gracias, señor presidente.\nALFREDO PÉREZ RUBALCABA:  Muchas gracias, señor presidente. Señor presidente del Gobierno, ¿considera que tiene un programa a la altura de las necesidades de España? (Rumores.)\nALFREDO PÉREZ RUBALCABA:  Muchas gracias, señor presidente.\nALFREDO PÉREZ RUBALCABA:  Muchas gracias, señor presidente. Usted y yo acabamos de hacer hace unas semanas una campaña electoral. En ella discutimos sobre lo que hemos hablado esta mañana, sobre ajustes e impuestos. Dije en la campaña al conjunto de los españoles que había que ajustar, que subir impuestos y expliqué cuáles subiría. Usted dijo que no, que no había que subirlos; al contrario, que había que bajarlos, y ciertamente, según llegó al Gobierno lo primero que ha hecho ha sido subir los impuestos. Ya sé que va a decir que se lo ha encontrado todo muy mal. Yo le digo que había que ajustar 16.000 millones como poco y que usted iba a subir los impuestos. Lo sabía perfectamente y ha hecho lo que tenía pensado hacer. Usted se pasó toda la legislatura anterior hablando de confianza, de ganar la confianza y de restaurar la confianza, y yo le digo que no es muy buena cosa para ganar la confianza empezar por hacer lo contrario de lo que se ha dicho en campaña electoral. Después fue a Bruselas y tuvo ese incidente que hemos comentado, que tampoco es muy buena forma de ganar la confianza; tiene a sus ministros disputando sobre distintas cosas, eso sí, lo hacen en distintos idiomas, lo cual le da un cierto carácter internacional; y el otro día recibe al señor Mas y con todo esto dice aquello que le oímos decir todos: vivo en un lío, y es verdad. Todo eso, señor Rajoy, no da confianza: ni hacer lo contrario de lo que se dice en campaña, ni que sus ministros se peleen y la vicepresidenta tenga que poner orden, ni que usted reconozca que vive en un lío, ni que usted hable de huelga general. Eso, señor Rajoy, no da confianza. Y yo le voy a decir que tenga usted cuidado con los micrófonos, señor Rajoy, no vaya a ser que los españoles empiecen a pensar que usted solo es sincero cuando cree que no le escuchan. Muchas gracias. (Aplausos.)",
"\nJOSÉ ANTONIO ALONSO SUÁREZ: CONSIDERA LA VICEPRESIDENTA QUE ESTÁ CUMPLIENDO SATISFACTORIAMENTE LAS FUNCIONES QUE TIENE ATRIBUIDAS EN EL GOBIERNO\nJOSÉ ANTONIO ALONSO SUÁREZ:  Señora vicepresidenta del Gobierno, señora Sáenz\nJOSÉ ANTONIO ALONSO SUÁREZ:  Señora vicepresidenta del Gobierno, señora Sáenz de Santamaría, ¿considera usted que está haciendo adecuadamente su labor, su función como vicepresidenta del Gobierno? (Rumores.)\nJOSÉ ANTONIO ALONSO SUÁREZ:  Verá, señora Sáenz de Santamaría, yo creía y tenía\nJOSÉ ANTONIO ALONSO SUÁREZ:  Verá, señora Sáenz de Santamaría, yo creía y tenía la esperanza de que los episodios de descoordinación a los que me iba a referir hubieran acabado, pero veo que siguen. Acaba de decir su jefe político, el señor presidente del Gobierno, don Mariano Rajoy, lo de la herencia a beneficio de inventario, y parece que usted, descoordinada con él, se acaba de referir a una herencia que sí que han aceptado, por lo que veo, a beneficio de inventario. (Rumores.- Aplausos.) Esas son malas cosas, señora Sáenz Santamaría, porque en las últimas semanas se suman a toda una secuencia imparable de descoordinaciones en el seno del Gobierno. Hay siempre dos, tres, cuatro voces de ministros que cada vez que ustedes sacan algo a la luz dicen una cosa unos, otra cosa otros, a veces no se sabe muy bien qué dicen unos ni se sabe muy bien qué dicen otros; y afecta a cosas importantes, a reformas legales importantes, a los cumplimientos del objetivo de déficit, a la definición general de la política económica; también a cuestiones muy importantes, como el control previo de los presupuestos de las comunidades autónomas, etcétera. Ayer mismo, el señor ministro de Justicia, don Alberto Ruiz-Gallardón, dijo muy claramente, muy claramente -y yo estoy de acuerdo con él- que la Ley de matrimonios homosexuales no es inconstitucional. Me gustaría saber su opinión, señora vicepresidenta, a propósito de esta nueva y seria descoordinación, porque desde luego si el encargado de la justicia del Gobierno tiene esa opinión, ustedes deberían retirar por una elemental coherencia jurídica y política ese recurso, señora vicepresidenta. (Aplausos.) Finalmente, quiero recordarle también que como responsable de comunicación del Gobierno, que también lo es -es en mi opinión la otra de sus grandes funciones-, ha tenido una evolución digamos que discutible. Empezó diciendo que iba a hacer una labor muy institucional, tardó en desmentirse, en descoordinarse consigo misma dos semanas cuando cargó contra Andalucía -utilizando, por cierto, una insidia objetivamente falsa- por su supuesta situación financiera. Aunque sea a costa de rectificarse a sí misma, coordínese, coordine con su jefe de filas y coordine con el conjunto del Gobierno, señora Sáenz de Santamaría. (Aplausos.)",
"\nJULIO VILLARRUBIA MEDIAVILLA: MANTIENE EL GOBIERNO SU INTENCIÓN DE IMPONER EL CONJUNTO DE CONTRARREFORMAS ANUNCIADAS POR EL MINISTRO DE JUSTICIA\nJULIO VILLARRUBIA MEDIAVILLA:  Gracias, señor presidente.\nJULIO VILLARRUBIA MEDIAVILLA:  Gracias, señor presidente. Señor ministro de Justicia, bienvenido en esta su primera intervención en el Pleno del Congreso y suerte en su gestión al frente del servicio público de la justicia. Señor ministro, en pocas semanas han ido anunciando preocupantes reformas dentro del ámbito de la Administración de Justicia. Algunas de ellas suponen graves recortes de derechos y libertades, otras constituyen una ruptura de los consensos básicos de las reglas del juego y un ataque a la propia soberanía popular en beneficio de corporaciones o gremios. Esto lo anuncia a la vez que hablan de consenso y, por ello, le pregunto: ¿Mantiene el Gobierno su intención de imponer el conjunto de contrarreformas anunciadas por el ministro de Justicia?\nJULIO VILLARRUBIA MEDIAVILLA:  Señor ministro, lo cierto es que ustedes\nJULIO VILLARRUBIA MEDIAVILLA:  Señor ministro, lo cierto es que ustedes vienen con propuestas de la derecha más reaccionaria (Rumores.), cediendo a presiones corporativas y religiosas. Ustedes proponen cárcel para los reincidentes de pequeños hurtos; cárcel para las mujeres que tengan que abortar (Rumores.); cadena perpetua, aunque la llamen prisión permanente revisable; copago importante en la Administración de Justicia, no depósito moderado para recurrir que existe hoy; regalos corporativos en bodas y divorcio a costa de los bolsillos de los ciudadanos; recortes en medios personales y materiales. El matrimonio entre las personas del mismo sexo dice usted que es constitucional, pero el Partido Popular mantiene el recurso ante el Tribunal Constitucional. Hurtan al Parlamento, a la soberanía popular y regalan al gremio de los jueces la elección de doce miembros del Consejo General del Poder Judicial, rompiendo consensos básicos respetados durante muchos años. Señor Gallardón, recapaciten ustedes. Van por muy mal camino, con reformas unilaterales y sin consensos que durarán el tiempo que ustedes estén en el Gobierno, que espero que no sea mucho. Así, su fracaso estará garantizado y no ayudará a la necesaria mejora del servicio público de la justicia. Rectifiquen, no vuelvan al viejo pasado, no recorten derechos y libertades y busquen, de verdad, el necesario consenso en esta cuestión de Estado que es la justicia. Gracias. (Aplausos.)",
"\nCARMEN MONTÓN GIMÉNEZ: CREE EL GOBIERNO QUE DEBEMOS RETROCEDER VEINTICINCO AÑOS EN LOS DERECHOS DE LAS MUJERES CON LA MODIFICACIÓN DE LA LEY DE SALUD SEXUAL Y REPRODUCTIVA Y DE LA INTERRUPCIÓN VOLUNTARIA DEL EMBARAZO\nCARMEN MONTÓN GIMÉNEZ:  Gracias, señor presidente.\nCARMEN MONTÓN GIMÉNEZ:  Gracias, señor presidente. Señor ministro, ¿por qué se opone a la salud sexual y reproductiva? En España tenemos una legislación integral centrada en el derecho a la salud y el reconocimiento de los derechos y la autonomía de las mujeres, que está basada en las recomendaciones de organismos internacionales, que está avalada por el Consejo de Estado, que está fundamentada en los principios de leyes europeas de nuestro entorno, que ha sido elaborada con el consenso de la gran mayoría de los grupos parlamentarios y que, además, está acompañada de una estrategia de prevención, porque nuestro objetivo es disminuir el número de embarazos no deseados y el de abortos, como así está siendo. ¿Cree el Gobierno que debe retroceder veinticinco años en los derechos de las mujeres y modificar esta ley? (Aplausos.)\nCARMEN MONTÓN GIMÉNEZ:  Señor ministro, lo que plantean en realidad es\nCARMEN MONTÓN GIMÉNEZ:  Señor ministro, lo que plantean en realidad es retroceder en el derecho de las mujeres a decidir sobre su propia maternidad. Quieren que sea una cuestión de permisos, supeditada a la decisión de terceros, y deje de ser un derecho. Están reeditando el debate de hace veinticinco años y pretenden que con el rodillo de su mayoría absoluta el resultado sea incluso más restrictivo y peligroso que la situación de 1985. Aunque lo que anhelan algunos miembros de su Gobierno -no sé si usted- es una prohibición total, comienzan por imponer un modelo de supuestos donde el aborto es delito, con pena de cárcel para las mujeres. Señor ministro, déjeme que le recuerde los intolerables y bochornosos episodios de persecución de mujeres y profesionales sanitarios que, aun actuando de acuerdo con la ley, fueron reclamados por los tribunales en 2007, en la Comunidad de Madrid. Su contrarreforma es muy preocupante y grave porque vuelve a instaurar la inseguridad jurídica para las mujeres y para los profesionales sanitarios y vuelve a abrir la puerta al aborto clandestino e inseguro. Con más castigo, con más Código Penal, no conseguirán disminuir las tasas de aborto; conseguirán más sufrimiento. Y con menos prevención, educación y acceso a métodos anticonceptivos y de emergencia, como la píldora del día después que están poniendo en cuestión, no conseguirán ni abstinencia ni castidad; conseguirán más riesgo para la salud y más embarazos no deseados. El Grupo Socialista se opondrá a la contrarreforma. (Una señora diputada. ¡Muy bien!- Aplausos.)",
"\nRAFAEL SIMANCAS SIMANCAS: QUÉ VALORACIÓN HACE EL GOBIERNO DE LA SITUACIÓN DEL TRANSPORTE AÉREO EN ESPAÑA\nRAFAEL SIMANCAS SIMANCAS:  Gracias, señor presidente.\nRAFAEL SIMANCAS SIMANCAS:  Gracias, señor presidente. Señora ministra, ¿qué valoración hace el Gobierno sobre la situación del transporte aéreo en España? Muchas gracias.\nRAFAEL SIMANCAS SIMANCAS:  Señora Pastor, dicen que es usted la ministra\nRAFAEL SIMANCAS SIMANCAS:  Señora Pastor, dicen que es usted la ministra más marianista del Gobierno (Risas.), y debe ser cierto, porque al menos en lo concerniente al transporte aéreo -permítame que se lo diga- vive usted en el lío permanente. Un país que depende intensamente de la buena marcha del turismo, como usted ha mencionado, no puede permitirse tener un sector de importancia tan estratégica como el transporte aéreo patas arriba, y así lo tiene usted, señora Pastor. Es verdad que no todos los desastres son de su exclusiva responsabilidad (Rumores.), pero, por ejemplo, culminar, dar un portazo al modelo aeroportuario en marcha sí ha sido decisión suya, con un argumento falso, porque 5.300 millones de canon para Barajas y El Prat no era una baratija, era más bien todo lo contrario. Ha puesto usted fin a un modelo aeroportuario que traía a España los criterios de eficiencia y competitividad que están triunfando en Europa, y además, ¿para qué? Porque no sabemos qué tienen ustedes en la cabeza respecto al modelo aeroportuario. ¿Van a privatizar AENA? ¿Qué van a hacer con AENA? Empresarios, usuarios e instituciones están ansiosos por saber qué quieren hacer ustedes con el transporte aéreo. Es verdad que Spanair, por hablar de otro asunto en el transporte aéreo, no ha sido la primera línea aérea que ha cerrado de una manera inadecuada, pero sí es la primera vez que lo han hecho con la aquiescencia y el apoyo del director general de Aviación Civil y de Fomento, según declaraciones del presidente de la compañía que ustedes no han desmentido públicamente. Tendrán que explicarnos por qué no se ha cerrado de una manera ordenada esta compañía aérea y tendrán que explicarnos por qué no ha habido suficiente previsión para evitar el desastre de 83.000 pasajeros en los aeropuertos sin vuelo durante una semana, 4.000 trabajadores en la calle de la noche a la mañana y un buen número de rutas sin cobertura, huelgas en Iberia y huelgas en Bajaras. Señora Pastor, va a tener usted toda nuestra ayuda, pero le rogaría que se dejara de líos marianistas y que en el futuro trabajara con algo más de rigor y de eficacia. Muchas gracias. (Aplausos.-Protestas.-Una señora diputada: ¡Muy bien!)"]}, {name: "republican", speeches: ["\nMARIANO RAJOY BREY:  He hablado en varias ocasiones a lo largo del debate que se ha producido en esta Cámara, hace muy breve periodo de tiempo, y he explicado qué es lo que había dicho y los porqués porque hay unos precedentes que están ahí. En cualquier caso, como luego hemos escuchado a algunos portavoces, estoy absolutamente convencido de que haremos una buena reforma laboral cuyo objetivo básico es que se produzca la contratación de personas. Tenemos muchísimos jóvenes en el paro y más de 5 millones que no pueden trabajar. Estoy absolutamente convencido, y se lo pido, de que ustedes y su grupo me van a ayudar para que la reforma laboral sea un éxito y para que eso que yo dije en Bruselas en una conversación que no quería que fuera pública, no se produzca. Gracias.\nMARIANO RAJOY BREY:  Señor Centella, por hacer un recordatorio histórico, esa ley electoral que tanto critica usted fue apoyada por el partido del que es hoy secretario general, por tanto, lo que he dicho antes respecto a la coherencia de algunos creo que sería bueno que se lo aplicara. (Aplausos.) Dice que no conoce la reforma del mercado laboral que va a presentar el Gobierno. Es verdad, porque no la hemos presentado. Lo que me sorprende es que después de decir que no la conoce la ponga de vuelta y media (Risas y aplausos.) y ya nos cuente en esta Cámara qué es lo que vamos a hacer los miembros de este Gobierno. Eso me resulta verdaderamente sorprendente. En cualquier caso, le voy a decir los objetivos de la propuesta que presentaremos en esta Cámara cuando la aprobemos en el Consejo de Ministros: la estabilidad en el empleo, la flexibilidad interna y, sobre todo, facilitar que haya mecanismos de ajuste en momentos difíciles alternativos a la destrucción de empleo. Lo que ha pasado en España es que todo el ajuste se ha producido en pérdida de empleo, sobre todo pérdida de empleos temporales y de las personas más jóvenes. Hay algunos que no quieren que haya una reforma del mercado laboral pero tiene que haber una reforma del mercado laboral porque, como usted muy bien ha dicho, más de la mitad de nuestros jóvenes no pueden trabajar. Y con esta ley es muy difícil que puedan trabajar, sobre todo en momentos de crisis y dificultades como las que estamos viviendo. Por tanto, haremos una ley que yo espero que cuente con su respaldo y con su apoyo -ya se lo pido y seguro que cuando la conozca le gusta-, pero haremos una ley porque es lo que necesita España junto con otras muchas cosas en estos momentos. Muchísimas gracias. (Aplausos.)\nMARIANO RAJOY BREY:  Señor Duran, le voy a responder lo que me dice la Agencia Estatal Tributaria. El sistema de devolución mensual del IVA a las empresas exportadoras es un régimen especial que permite a los exportadores obtener la devolución del IVA al final de cada mes, sin tener que esperar al final del año natural. Y el plazo de la devolución es desde el 1 hasta el 20 del mes siguiente, es decir, que las devoluciones por operaciones realizadas en el mes de enero se solicitarían entre el 1 y el 20 de febrero. Según dice la Agencia Estatal Tributaria, el plazo medio de las devoluciones en 2011 fue de 44 días; en aquellas que no han presentado irregularidades fue de 21 y de 50 aquellas que fueron objeto de un procedimiento de comprobación tributaria. Es decir, si hoy 8 de febrero un exportador presenta su solicitud de devolución por las operaciones realizadas en enero, la devolución la recibirá antes de que acabe el mes, en concreto el 27 de febrero si es una empresa adscrita a la Delegación central de grandes contribuyentes o el 29 de febrero si no lo fuera. A mi estos plazos me parecen razonables; en cualquier caso, nunca renunciaré a hacer las cosas mucho mejor de lo que se hacen, pero no me parece que la Agencia Estatal Tributaria sea el órgano más ineficiente del conjunto de las administraciones públicas como sabe mucha gente. Muchas gracias.\nMARIANO RAJOY BREY:  Me alegraría mucho, señor Duran, de que esos datos que usted ha citado fuesen la excepción que confirman la regla general que afirmé en la respuesta en mi primera intervención. En cualquier caso, me importa mucho eso. Con que haya una sola persona o pequeña y mediana empresa que tenga dificultades de ese tipo, el Gobierno tiene la obligación de preocuparse y yo lo hago. Le agradeceré, si usted lo ve bien, que me dé esos datos en la medida en que yo pueda conocerlos, porque estoy de acuerdo con que debemos hacer todo cuanto esté en nuestras manos para evitar que se produzcan acontecimientos de ese tipo. También he pedido los datos de la Delegación Especial de la Agencia Tributaria en Cataluña -porque supongo que esos datos serán fundamentalmente de Cataluña- y me dicen que gestiona proporcionalmente más devoluciones que el resto de las delegaciones de la Agencia Tributaria -en concreto, 53.931, un 27 por ciento- y que el tiempo medio de tramitación en Cataluña en el pasado año 2011 fue de 33 días, es decir, 11 menos que la media nacional. Cuando no hubo incidencias el tiempo medio fue de 17 días, cuatro menos que la media nacional, y cuando fueron necesarias comprobaciones fue de 37 días. En cualquier caso, estoy dispuesto a considerar lo que usted me ha dicho y con mucho gusto intentaré resolverlo. (Aplausos.)\nMARIANO RAJOY BREY:  Si considerara que no tengo un programa de gobierno a la altura de las necesidades de España, tendría otro. Como usted puede entender perfectamente, yo quiero tener un programa de gobierno a la altura de las necesidades de España y creo que tengo un programa a la altura de las necesidades de nuestro país en estos momentos. (Aplausos.)\nMARIANO RAJOY BREY:  Como todo el mundo habrá podido comprobar, su intervención ha sido de gran altura y sin duda alguna dará mucha confianza a los españoles, pero tampoco es muy preocupante, porque sus responsabilidades, por fortuna, son ahora menores que cuando estaba en el Gobierno y nos dejó las cosas como nos las ha dejado. (Aplausos.) En campaña electoral sucedieron muchas cosas, entre otras una muy importante, que se nos estuvo diciendo al conjunto de los españoles que íbamos a cumplir los compromisos de déficit público que habíamos asumido con la Unión Europea, el 6 por ciento, y después de la campaña electoral vimos que el déficit público estaba por encima del 8 por ciento. Eso es lo más importante de los problemas de confianza que se generaron en nuestro país en el futuro, porque un país que se compromete al 6 y llega a Europa con más del 8 es evidentemente un país que no genera confianza. Por tanto, lecciones, las imprescindibles, señor Pérez Rubalcaba. (Aplausos.)",
"\nMARÍA SORAYA SÁENZ DE SANTAMARÍA ANTÓN:  Usted me pregunta si me siento satisfecha de la tarea del Gobierno y, mire, es difícil sentirme satisfecha mientras en este país haya más de 5 millones de parados. Es difícil que se sienta satisfecho el Gobierno que se ha encontrado esta situación, pero parece increíble que lo pregunte alguien que ha apoyado al Gobierno que dejó 5 millones de parados. La cuestión no es que estemos satisfechos unos y otros, sino lo que unos y otros hicieron y lo que otros vamos a hacer para sacar a este país de la crisis. (Aplausos.)\nMARÍA SORAYA SÁENZ DE SANTAMARÍA ANTÓN:  Señor Alonso, para ser un Gobierno tan descoordinado este Gobierno ha hecho en siete semanas lo que el suyo no se atrevió a hacer ni a empezar en siete años. (Aplausos.-Rumores.) Este Gobierno habla con sus decisiones y este Gobierno ha tomado la decisión de ser austero, y la primera medida ha sido aprobar un acuerdo de no disponibilidad de 9.000 millones de euros para ajustar ese desfase presupuestario que ustedes dejaron y que no fueron capaces de controlar. Y como había que ser austero y había que controlar el déficit público, este Gobierno ha presentado ya una ley de estabilidad presupuestaria. Y descoordinación, con todo respeto, sería, señor portavoz, que ustedes pactaran una cosa en agosto, usted y yo, y acabaran desdiciéndose de lo que pactaron en febrero. Y este Gobierno, señoría, está decidido a que vuelva el crédito a las empresas y a las familias y ha aprobado una reforma del sistema financiero y ha recortado el sueldo de los directivos de las entidades que reciben ayudas públicas, eso que ustedes decían mucho y que nunca hicieron. Y tiene compromiso con el Estado del bienestar y, por eso, ha actualizado este Gobierno las pensiones, esas que ustedes recortaron. Eso en cincuenta días. Usted es juez y no creo que tenga que señalarle que existe una cosa que se llama legitimación y legitimación activa. El recurso del que usted habla no es un recurso de este Gobierno, es un recurso de más de cincuenta diputados que son titulares de esa iniciativa, y ellos responderán lo que quieren hacer con ese recurso. (Rumores.) Usted me pregunta -y lo ha sacado usted- sobre Andalucía. No lo he sacado yo, lo ha sacado usted en esta Cámara. Le voy a decir una cosa. ¿Sabe lo que más daño hace a los andaluces? Que se hayan gastado el dinero determinados miembros del Gobierno de Andalucía de los ERE en el pago de prejubilaciones falsas de señores que nunca trabajaron. (Aplausos.-Rumores.) ¿Y sabe lo que pone en duda las cuentas? Que un día el presidente de Andalucía diga que el déficit es el 1,4 y al día siguiente la consejera diga que es del 3 por ciento. Coordinación, señor Alonso. Coordinen también a sus compañeros de Andalucía. Pero la mayor descoordinación, la mayor insatisfacción, señorías, es que ustedes llegaron prometiendo el pleno empleo y han dejado 5 millones de parados. Nosotros... (Aplausos.)",
"\nALBERTO RUIZ-GALLARDÓN JIMÉNEZ:  Gracias, señor presidente. Señoría, le agradezco sus buenas palabras, pero tengo que decirle que me sorprende mucho su pregunta. Desconozco qué experiencia tiene usted de otros gobiernos, pero lo normal es que cuando el Ejecutivo anuncia un conjunto de medidas es precisamente para eso, para aplicarlas. Gracias, señor presidente. (Aplausos.)\nALBERTO RUIZ-GALLARDÓN JIMÉNEZ:  Gracias, señor presidente. Señor Villarrubia, en términos tenísticos podríamos decir que usted pretende echarme aquí la revancha de la comparecencia de la Comisión, porque saca todos los temas que no supo, no pudo o no quiso contestar cuando tuvo ocasión de ello en la Comisión. Evidentemente, no los voy a tratar todos. Pero déjeme que le diga lo que ocurría en España el día que este ministro de Justicia tomó posesión de su cargo, porque es importante que usted lo sepa. Ese día teníamos 3.225.000 pleitos pendientes. Ese día teníamos 2.398.000 ejecuciones de sentencia en trámite. Ese día el Consejo General del Poder Judicial me informó que en el año 2010 se habían producido ante el mismo 13.000 quejas, y el 75 por ciento de las mismas relativas al funcionamiento de la justicia, en donde el ciudadano dice que la justicia ni es atenta ni es ágil ni es tecnológica. Señoría, esto es lo que yo me encontré. ¿Me dice usted que ante este panorama lo que tenía que haber hecho este ministro y su equipo es mantener, en aras de no sé qué acuerdos anteriores, una situación que en estos momentos tiene paralizadas decenas de miles de millones de euros, que tenían que estar incorporados a la producción de este país? ¿Me dice usted que tenía que haber permanecido cruzado de brazos cuando hay millones de españoles que no ven satisfecha la resolución de sus conflictos? Lo siento pero no, señor Villarrubia. Eso no es lo que va a hacer este ministro. Pero déjeme que le conteste solamente a dos asuntos que no salieron en la Comisión y que por eso sí me parecen procedentes. En primer lugar, como ha explicado la vicepresidenta, con relación al recurso de inconstitucionalidad, ese recurso si usted hubiese estudiado más -porque capacidad, sin duda, no le falta- sabría, primero, que no es del Gobierno sino del grupo; y que no es de este grupo, sino que es del grupo anterior; y que la doctrina del Tribunal Constitucional impide al grupo subsiguiente retirar uno que trae causa del anterior. Pero déjeme que le diga una cosa, que es lo más importante de todo. Mi opinión es conocida desde hace muchos años. Yo soy ministro del Gobierno de España y, por lo tanto, defiendo la postura de mi partido, que es estar a lo que diga el Tribunal Constitucional, y esa es -y no tenga ninguna duda- la opinión del ministro de Justicia. Muchas gracias, señor presidente. (Aplausos.)\nALBERTO RUIZ-GALLARDÓN JIMÉNEZ:  Gracias, señor presidente. Señoría, este Gobierno no va a retroceder ni en la defensa de los derechos de la mujer ni tampoco en la defensa de los derechos del concebido y no nacido. Lo que va a hacer es buscar, de acuerdo con la doctrina del Tribunal Constitucional, una solución jurídica en el caso de que ambos entren en conflicto, porque lo que sí es un retroceso es haber eliminado, como hicieron ustedes en la última reforma, uno de esos dos derechos. Gracias, señor presidente. (Aplausos.)\nALBERTO RUIZ-GALLARDÓN JIMÉNEZ:  Gracias, señor presidente. Me dice usted que lo que nosotros queremos es retrógrado y peligroso. ¿Es retrógrado y peligroso seguir la doctrina del Tribunal Constitucional? (Una señora diputada: ¡Muy bien!) ¿Es retrógrado y peligroso hacer, como se hizo en 1985 por un Gobierno presidido por don Felipe González, caso a la doctrina del Tribunal Constitucional? ¿Era peligroso y retrógrado el señor González? ¿Lo era el señor Rubalcaba, que estaba con él? (Rumores.) ¿Es decir que no tiene consenso una ley que ha estado vigente once años gobernando el Partido Socialista, ocho años gobernando el Partido Popular y cinco años gobernando el Partido Socialista otra vez hasta que ustedes la reformaron, por cierto, sin haberlo pactado no digo ya con esta Cámara, sino ni siquiera con sus electores porque no lo llevaban en el programa electoral? (Aplausos.) Señora Montón, durante veinticinco años en un tema durísimo, dificilísimo, tremendo y grave para la mujer, ha habido un consenso que nos lo marcó el Tribunal Constitucional. Ustedes vulneraron esa doctrina porque ustedes estableciendo un sistema en el que durante unos días determinados, un plazo determinado, el concebido y no nacido perdía toda protección, lo que hicieron es romper la doctrina del Tribunal Constitucional que decía que, por supuesto, el derecho a la interrupción del embarazo la mujer lo tenía en aquellos supuestos en que el conflicto equiparase los dos valores jurídicos protegidos. Déjeme que le diga una cosa: ninguna mujer en esos veinticinco años fue en España a la cárcel y ninguna mujer irá a la cárcel con una ley aprobada por el Partido Popular. Y le digo otra cosa más. Usted habla del derecho al aborto, pero yo le quiero hablar también del derecho a la maternidad; del derecho como una opción de la mujer. (Rumores.-Risas.) Sí, ustedes se ríen, pero yo estoy pensando en las mujeres menores de edad, estoy pensando en las mujeres discapacitadas, estoy pensando en las mujeres emigrantes. Ustedes a esas mujeres cuando se quedan embarazadas la única respuesta que les dan es: Ahí tiene usted la Ley del Aborto. (Una señora diputada: ¡Cómo puedes decir eso!- Rumores.) Nosotros la respuesta que les vamos a dar es una respuesta positiva para que puedan ejercer el derecho a la maternidad. Esa es la diferencia, señor presidente. Muchas gracias. (Aplausos.-Rumores.)",
"\nANA MARÍA PASTOR JULIÁN:  Muchas gracias, señor presidente. Señoría, para este Gobierno este sector tiene un papel fundamental desde el punto de vista económico. Es un gran dinamizador de nuestro turismo y además es un elemento clave para la cohesión territorial y para la conexión con el resto de los países del mundo.\nANA MARÍA PASTOR JULIÁN:  Muchas gracias, señor presidente. Señoría, le he escuchado a usted y no hay quien le reconozca. Escuchándole tendría que decirles cuáles han sido sus palabras hasta ahora. Mire, señoría, para dar lecciones, hay que pensar en el pasado que tiene cada uno, y usted pertenece a un grupo político que mientras gobernó estos ocho años fuimos testigos del cierre de diez compañías aéreas, tuvimos huelgas de todo, de compañías, de trabajadores, de empresas de aeropuerto; hubo una huelga que incluso, como usted conoce, llevó a declarar el estado de sitio. Hubo empresas del sector que cerraron, hubo un deterioro de la puntualidad de 13 puntos, como nunca se había conocido en nuestro país. O sea, señor Simancas, lecciones, las justas, y sepa que yo estoy en el Gobierno, ese Gobierno que dice usted marianista -claro que somos marianistas; estamos presididos por un señor que se llama Mariano Rajoy-, que va a hacer que el sector aéreo vuelva a tener el papel que le corresponde en España y en el mundo. Le voy a decir más, señor Simancas, usted me ha puesto el ejemplo de Spanair. Mire, hicimos todo lo que podíamos hacer. Por cierto, ese señor al que usted le da tanta credibilidad nos avisó a las ocho y cuarto de la tarde de que había cerrado a las ocho menos cuarto de la tarde. Y le voy a decir más, lo que le ha pasado a esa compañía se lo tiene que preguntar usted a sus compañeros del Partido Socialista de Cataluña, que fueron los que iniciaron esa aventura que les ha conducido hasta aquí.(Aplausos.-Un señor diputado: ¡Muy bien!) Le voy a decir más, este sector es muy importante, pero tendría usted que informarse mejor cuando viene aquí, porque nos han dejado AENA, compañía líder en España y en el mundo, con un agujero, con una deuda entre el largo y el corto de más de 14.000 millones de euros. Lecciones, las justas, señor Simancas. (Aplausos.-Varios señores diputados: ¡Bien!)"]}].map(party);

data.speakers = {"JOSÉ LUIS CENTELLA GÓMEZ": {name: "JOSÉ LUIS CENTELLA GÓMEZ", title: "Izquierda Unida"}, "JOSÉ LUIS CENTELLA GÓMEZ": {name: "José Luis Centella Gómez", title: "Izquierda Unida"}, "MARIANO RAJOY BREY": {name: "Mariano Rajoy Brey", title: "Popular (PP)"}, "JOSEP ANTONI DURAN I LLEIDA": {name: "JOSEP ANTONI DURAN I LLEIDA", title: "Convergència i Unió"}, "JOSEP ANTONI DURAN I LLEIDA": {name: "Josep Antoni Duran i Lleida", title: "Convergència i Unió"}, "ALFREDO PÉREZ RUBALCABA": {name: "ALFREDO PÉREZ RUBALCABA", title: "Socialista (PSOE)"}, "ALFREDO PÉREZ RUBALCABA": {name: "Alfredo Pérez Rubalcaba", title: "Socialista (PSOE)"}, "JOSÉ ANTONIO ALONSO SUÁREZ": {name: "JOSÉ ANTONIO ALONSO SUÁREZ", title: "Socialista (PSOE)"}, "JOSÉ ANTONIO ALONSO SUÁREZ": {name: "José Antonio Alonso Suárez", title: "Socialista (PSOE)"}, "MARÍA SORAYA SÁENZ DE SANTAMARÍA ANTÓN": {name: "María Soraya Sáenz de Santamaría Antón", title: "Popular (PP)"}, "JULIO VILLARRUBIA MEDIAVILLA": {name: "JULIO VILLARRUBIA MEDIAVILLA", title: "Socialista (PSOE)"}, "JULIO VILLARRUBIA MEDIAVILLA": {name: "Julio Villarrubia Mediavilla", title: "Socialista (PSOE)"}, "ALBERTO RUIZ-GALLARDÓN JIMÉNEZ": {name: "Alberto Ruiz-Gallardón Jiménez", title: "Popular (PP)"}, "CARMEN MONTÓN GIMÉNEZ": {name: "CARMEN MONTÓN GIMÉNEZ", title: "Socialista (PSOE)"}, "CARMEN MONTÓN GIMÉNEZ": {name: "Carmen Montón Giménez", title: "Socialista (PSOE)"}, "RAFAEL SIMANCAS SIMANCAS": {name: "RAFAEL SIMANCAS SIMANCAS", title: "Socialista (PSOE)"}, "RAFAEL SIMANCAS SIMANCAS": {name: "Rafael Simancas Simancas", title: "Socialista (PSOE)"}, "ANA MARÍA PASTOR JULIÁN": {name: "Ana María Pastor Julián", title: "Popular (PP)"}};

data.topics = [{name: "justicia", re: /\b(justicia)\b/gi, x: 28.0, y: 28.0}, {name: "reforma laboral", re: /\b(reforma laboral)\b/gi, x: 50.0, y: 18.0}, {name: "agencia", re: /\b(agencia)\b/gi, x: 68.0, y: 14.0}, {name: "empresas", re: /\b(empresas)\b/gi, x: 86.0, y: 14.0}, {name: "empresa", re: /\b(empresa)\b/gi, x: 102.0, y: 12.0}, {name: "datos", re: /\b(datos)\b/gi, x: 116.0, y: 10.0}, {name: "agencia tributaria", re: /\b(agencia tributaria)\b/gi, x: 128.0, y: 8.0}, {name: "huelga general", re: /\b(huelga general)\b/gi, x: 138.0, y: 6.0}, {name: "mercado laboral", re: /\b(mercado laboral)\b/gi, x: 148.0, y: 6.0}, {name: "despido", re: /\b(despido)\b/gi, x: 156.0, y: 4.0}, {name: "trabajadores", re: /\b(trabajadores)\b/gi, x: 164.0, y: 4.0}, {name: "servicio público", re: /\b(servicio público)\b/gi, x: 172.0, y: 4.0}, {name: "consejo general", re: /\b(consejo general)\b/gi, x: 180.0, y: 4.0}, {name: "economía", re: /\b(economía)\b/gi, x: 188.0, y: 4.0}, {name: "paro", re: /\b(paro)\b/gi, x: 194.0, y: 2.0}].map(topic);

data.topic = function(name) {
  var t = topic({name: name, re: new RegExp("\\b(" + d3.requote(name) + ")\\b", "gi")}, data.topics.length);
  data.topics.push(t);
  return t;
};

function party(party) {
  party.speeches = party.speeches.map(speech);
  party.sections = sections(party.speeches);
  party.wordCount = d3.sum(party.sections, function(d) { return countWords(d.speech.text.substring(d.i, d.j)); });
  return party;
}

function speech(text, i) {
  return {text: text, id: i};
}

function sections(speeches) {
  // PFS: Afegeixo alguns caracters accentuats que no pertanyen a l'alfabet anglès
  // var speakerRe = /(?:\n|^)([A-Z\.()\- ]+): /g,
  var speakerRe = /(?:\n|^)([A-ZÁÉÍÓÚÑÀÈÇ\.()\- ]+): /g,
      sections = [];

  speeches.forEach(function(speech) {
    var speakerName = "AUDIENCE",
        match,
        i = speakerRe.lastIndex = 0;
    while (match = speakerRe.exec(speech.text)) {
      if (match.index > i) sections.push({speaker: speakerName, speech: speech, i: i, j: match.index});
      speakerName = match[1];
      i = speakerRe.lastIndex;
    }
    sections.push({speaker: speakerName, speech: speech, i: i, j: speech.text.length});
  });

  return sections.filter(function(d) { return !/^AUDIENCE\b/.test(d.speaker); });
}

function topic(topic, i) {
  topic.id = i;
  topic.count = 0;
  topic.cx = topic.x;
  topic.cy = topic.y;

  topic.parties = data.parties.map(function(party) {
    var count = 0,
        mentions = [];

    party.sections.forEach(function(section) {
      var text = section.speech.text.substring(section.i, section.j), match;
      topic.re.lastIndex = 0;
      while (match = topic.re.exec(text)) {
        ++count;
        mentions.push({
          topic: topic,
          section: section,
          i: section.i + match.index,
          j: section.i + topic.re.lastIndex
        });
      }
    });

    topic.count += count = count / party.wordCount * 25e3;
    return {count: count, mentions: mentions};
  });

  return topic;
}

function countWords(text) {
  return text.split(/\s+/g)
      .filter(function(d) { return d !== "—"; })
      .length;
}

})();

(function() {

var width = 970,
    height = 540;

var collisionPadding = 4,
    clipPadding = 4,
    minRadius = 16, // minimum collision radius
    maxRadius = 65, // also determines collision search radius
    maxMentions = 100, // don't show full transcripts
    activeTopic; // currently-displayed topic

var formatShortCount = d3.format(",.0f"),
    formatLongCount = d3.format(".1f"),
    formatCount = function(d) { return (d < 10 ? formatLongCount : formatShortCount)(d); };

var r = d3.scale.sqrt()
    .domain([0, d3.max(data.topics, function(d) { return d.count; })])
    .range([0, maxRadius]);

var force = d3.layout.force()
    .charge(0)
    .size([width, height - 80])
    .on("tick", tick);

var node = d3.select(".g-nodes").selectAll(".g-node"),
    label = d3.select(".g-labels").selectAll(".g-label"),
    arrow = d3.select(".g-nodes").selectAll(".g-note-arrow");

d3.select(".g-nodes").append("rect")
    .attr("class", "g-overlay")
    .attr("width", width)
    .attr("height", height)
    .on("click", clear);

d3.select(window)
    .on("hashchange", hashchange);

d3.select("#g-form")
    .on("submit", submit);

updateTopics(data.topics);
hashchange();

// Update the known topics.
function updateTopics(topics) {
  topics.forEach(function(d) {
    d.r = r(d.count);
    d.cr = Math.max(minRadius, d.r);
    d.k = fraction(d.parties[0].count, d.parties[1].count);
    if (isNaN(d.k)) d.k = .5;
    if (isNaN(d.x)) d.x = (1 - d.k) * width + Math.random();
    d.bias = .5 - Math.max(.1, Math.min(.9, d.k));
  });
  force.nodes(data.topics = topics).start();
  updateNodes();
  updateLabels();
  updateArrows();
  tick({alpha: 0}); // synchronous update
}

// Update the displayed nodes.
function updateNodes() {
  node = node.data(data.topics, function(d) { return d.name; });

  node.exit().remove();

  var nodeEnter = node.enter().append("a")
      .attr("class", "g-node")
      .attr("xlink:href", function(d) { return "#" + encodeURIComponent(d.name); })
      .call(force.drag)
      .call(linkTopic);

  var democratEnter = nodeEnter.append("g")
      .attr("class", "g-democrat");

  democratEnter.append("clipPath")
      .attr("id", function(d) { return "g-clip-democrat-" + d.id; })
    .append("rect");

  democratEnter.append("circle");

  var republicanEnter = nodeEnter.append("g")
      .attr("class", "g-republican");

  republicanEnter.append("clipPath")
      .attr("id", function(d) { return "g-clip-republican-" + d.id; })
    .append("rect");

  republicanEnter.append("circle");

  nodeEnter.append("line")
      .attr("class", "g-split");

  node.selectAll("rect")
      .attr("y", function(d) { return -d.r - clipPadding; })
      .attr("height", function(d) { return 2 * d.r + 2 * clipPadding; });

  node.select(".g-democrat rect")
      .style("display", function(d) { return d.k > 0 ? null : "none" })
      .attr("x", function(d) { return -d.r - clipPadding; })
      .attr("width", function(d) { return 2 * d.r * d.k + clipPadding; });

  node.select(".g-republican rect")
      .style("display", function(d) { return d.k < 1 ? null : "none" })
      .attr("x", function(d) { return -d.r + 2 * d.r * d.k; })
      .attr("width", function(d) { return 2 * d.r; });

  node.select(".g-democrat circle")
      .attr("clip-path", function(d) { return d.k < 1 ? "url(#g-clip-democrat-" + d.id + ")" : null; });

  node.select(".g-republican circle")
      .attr("clip-path", function(d) { return d.k > 0 ? "url(#g-clip-republican-" + d.id + ")" : null; });

  node.select(".g-split")
      .attr("x1", function(d) { return -d.r + 2 * d.r * d.k; })
      .attr("y1", function(d) { return -Math.sqrt(d.r * d.r - Math.pow(-d.r + 2 * d.r * d.k, 2)); })
      .attr("x2", function(d) { return -d.r + 2 * d.r * d.k; })
      .attr("y2", function(d) { return Math.sqrt(d.r * d.r - Math.pow(-d.r + 2 * d.r * d.k, 2)); });

  node.selectAll("circle")
      .attr("r", function(d) { return r(d.count); });
}

// Update the displayed node labels.
function updateLabels() {
  label = label.data(data.topics, function(d) { return d.name; });

  label.exit().remove();

  var labelEnter = label.enter().append("a")
      .attr("class", "g-label")
      .attr("href", function(d) { return "#" + encodeURIComponent(d.name); })
      .call(force.drag)
      .call(linkTopic);

  labelEnter.append("div")
      .attr("class", "g-name")
      .text(function(d) { return d.name; });

  labelEnter.append("div")
      .attr("class", "g-value");

  label
      .style("font-size", function(d) { return Math.max(8, d.r / 2) + "px"; })
      .style("width", function(d) { return d.r * 2.5 + "px"; });

  // Create a temporary span to compute the true text width.
  label.append("span")
      .text(function(d) { return d.name; })
      .each(function(d) { d.dx = Math.max(d.r * 2.5, this.getBoundingClientRect().width); })
      .remove();

  label
      .style("width", function(d) { return d.dx + "px"; })
    .select(".g-value")
      .text(function(d) { return formatShortCount(d.parties[0].count) + " - " + formatShortCount(d.parties[1].count); });

  // Compute the height of labels when wrapped.
  label.each(function(d) { d.dy = this.getBoundingClientRect().height; });
}

// Update the active topic.
function updateActiveTopic(topic) {
  d3.selectAll(".g-head").attr("class", topic ? "g-head g-has-topic" : "g-head g-hasnt-topic");
  if (activeTopic = topic) {
    node.classed("g-selected", function(d) { return d === topic; });
    updateMentions(findMentions(topic));
    d3.selectAll(".g-head a").text(topic.name);
    d3.select(".g-democrat .g-head span.g-count").text(formatCount(topic.parties[0].count));
    d3.select(".g-republican .g-head span.g-count").text(formatCount(topic.parties[1].count));
  } else {
    node.classed("g-selected", false);
    updateMentions(sampleMentions());
    d3.selectAll(".g-head a").text("various topics");
    d3.selectAll(".g-head span.g-count").text("some number of");
  }
}

// Update displayed excerpts.
function updateMentions(mentions) {
  var column = d3.selectAll(".g-mentions")
      .data(mentions);

  column.select(".g-truncated")
      .style("display", function(d) { return d.truncated ? "block" : null; });

  var mention = column.selectAll(".g-mention")
      .data(groupMentionsBySpeaker, function(d) { return d.key; });

  mention.exit().remove();

  mention.selectAll("p")
      .remove();

  var mentionEnter = mention.enter().insert("div", ".g-truncated")
      .attr("class", "g-mention");

  mentionEnter.append("div")
      .attr("class", "g-speaker")
      .text(function(d) { var s = data.speakers[d.key]; return s ? s.name : d.key; });

  mentionEnter.append("div")
      .attr("class", "g-speaker-title")
      .text(function(d) { var s = data.speakers[d.key]; return s && s.title; });

  mention
      .sort(function(a, b) { return b.values.length - a.values.length; });

  var p = mention.selectAll("p")
      .data(function(d) { return d.values; })
    .enter().append("p")
      .html(function(d) { return d.section.speech.text.substring(d.start, d.end).replace(d.topic.re, "<a>$1</a>"); });

  if (activeTopic) {
    p.attr("class", "g-hover");
  } else {
    p.each(function(d) {
      d3.select(this).selectAll("a")
          .datum(d.topic)
          .attr("href", "#" + encodeURIComponent(d.topic.name))
          .call(linkTopic);
    });
  }
}

// Bind the arrow path elements with their associated topic.
function updateArrows() {
  arrow = arrow.data(
      data.topics.filter(function(d) { return d.arrow; }),
      function(d) { return this.id ? this.id.substring(8) : d.arrow; });
}

// Return a random sample of mentions per party, one per topic.
// Mentions are returned in chronological order.
function sampleMentions() {
  return data.parties.map(function(party, i) {
    return data.topics
        .map(function(d) { return d.parties[i].mentions; })
        .filter(function(d) { return d.length; })
        .map(function(d) { return d[Math.floor(Math.random() * d.length)]; })
        .sort(orderMentions);
  });
}

// Return displayable mentions per party for the specified topic.
// If too many, a random sample of matching mentions is returned.
// Mentions are returned in chronological order.
function findMentions(topic) {
  return data.parties.map(function(party, i) {
    var mentions = topic.parties[i].mentions;
    if (mentions.length > maxMentions) {
      shuffle(mentions).length = maxMentions;
      mentions.sort(orderMentions);
      mentions.truncated = true;
    }
    return mentions;
  });
}

// Group mentions by speaker, collapse overlapping excerpts.
function groupMentionsBySpeaker(mentions) {
  return d3.nest()
      .key(function(d) { return d.section.speaker; })
      .rollup(collapseMentions)
      .entries(mentions);
}

// Given an array of mentions, computes the start and end point of the context
// excerpt, and then collapses any overlapping excerpts.
function collapseMentions(mentions) {
  var sentenceRe = /([!?.)]+)\s+/g, // sentence splitting requires NLP
      i,
      n = mentions.length,
      d0,
      d1;

  // First compute the excerpt contexts.
  for (i = 0; i < n; ++i) {
    d0 = mentions[i];
    d0.start = excerptStart(d0);
    d0.end = excerptEnd(d0);
  }

  // Then collapse any overlapping excerpts (from the same speech).
  for (i = 1, d1 = mentions[0]; i < n; ++i) {
    d0 = d1;
    d1 = mentions[i];
    if (d1.section.speech.id === d0.section.speech.id
        && d1.start >= d0.start
        && d1.start < d0.end) {
      d1.start = -1;
      d0.end = d1.end;
      d1 = d0;
    }
  }

  // Returns the start index of the excerpt for the specified mention.
  function excerptStart(mention) {
    var i = sentenceRe.lastIndex = Math.max(mention.section.i, mention.i - 80), match;
    while (match = sentenceRe.exec(mention.section.speech.text)) {
      if (match.index < mention.i - 20) return match.index + match[0].length;
      if (i <= mention.section.i) break;
      sentenceRe.lastIndex = i = Math.max(mention.section.i, i - 20);
    }
    return mention.section.i;
  }

  // Returns the end index of the excerpt for the specified mention.
  function excerptEnd(mention) {
    var i = mention.section.j, match;
    sentenceRe.lastIndex = mention.j + 40;
    match = sentenceRe.exec(mention.section.speech.text);
    return match ? Math.min(match.index + match[1].length, i) : i;
  }

  return mentions.filter(function(d) { return d.start >= 0; });
}

// Orders mentions chronologically: by speech and position within speech.
function orderMentions(a, b) {
  return a.section.speech.id - b.section.speech.id || a.i - b.i;
}

// Assign event handlers to topic links.
function linkTopic(a) {
  a   .on("click", click)
      .on("mouseover", mouseover)
      .on("mouseout", mouseout);
}

// Returns the topic matching the specified name, approximately.
// If no matching topic is found, returns undefined.
function findTopic(name) {
  for (var i = 0, n = data.topics.length, t; i < n; ++i) {
    if ((t = data.topics[i]).name === name || new RegExp("^" + (t = data.topics[i]).re.source + "$", "i").test(name)) {
      return t;
    }
  }
}

// Returns the topic matching the specified name, approximately.
// If no matching topic is found, a new one is created.
function findOrAddTopic(name) {
  var topic = findTopic(name);
  if (!topic) {
    topic = data.topic(name.substring(0, 1).toUpperCase() + name.substring(1));
    topic.y = 0;
    updateTopics(data.topics);
  }
  return topic;
}

// Simulate forces and update node and label positions on tick.
function tick(e) {
  node
      .each(bias(e.alpha * 105))
      .each(collide(.5))
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

  label
      .style("left", function(d) { return (d.x - d.dx / 2) + "px"; })
      .style("top", function(d) { return (d.y - d.dy / 2) + "px"; });

  arrow.style("stroke-opacity", function(d) {
    var dx = d.x - d.cx, dy = d.y - d.cy;
    return dx * dx + dy * dy < d.r * d.r ? 1: 0;
  });
}

// A left-right bias causing topics to orient by party preference.
function bias(alpha) {
  return function(d) {
    d.x += d.bias * alpha;
  };
}

function rotate() {
	return function(d) {
	var c = Math.cos(Math.PI/8.);
	var s = Math.sin(Math.PI/8.);
	
	d.x -= width/2.;
	d.y -= height/2.
	
	var n_x = d.x*c - d.y*s;
	var n_y = d.x*s + d.y*c;
	
	d.x = n_x + width/2.;
	d.y = n_y + height/2.;
	};
}

// Resolve collisions between nodes.
function collide(alpha) {
  var q = d3.geom.quadtree(data.topics);
  return function(d) {
    var r = d.cr + maxRadius + collisionPadding,
        nx1 = d.x - r,
        nx2 = d.x + r,
        ny1 = d.y - r,
        ny2 = d.y + r;
    q.visit(function(quad, x1, y1, x2, y2) {
      if (quad.point && (quad.point !== d) && d.other !== quad.point && d !== quad.point.other) {
        var x = d.x - quad.point.x,
            y = d.y - quad.point.y,
            l = Math.sqrt(x * x + y * y),
            r = d.cr + quad.point.r + collisionPadding;
        if (l < r) {
          l = (l - r) / l * alpha;
          d.x -= x *= l;
          d.y -= y *= l;
          quad.point.x += x;
          quad.point.y += y;
        }
      }
      return x1 > nx2 || x2 < nx1 || y1 > ny2 || y2 < ny1;
    });
  };
}

// Fisher–Yates shuffle.
function shuffle(array) {
  var m = array.length, t, i;
  while (m) {
    i = Math.floor(Math.random() * m--);
    t = array[m];
    array[m] = array[i];
    array[i] = t;
  }
  return array;
}

// Given two quantities a and b, returns the fraction to split the circle a + b.
function fraction(a, b) {
  var k = a / (a + b);
  if (k > 0 && k < 1) {
    var t0, t1 = Math.pow(12 * k * Math.PI, 1 / 3);
    for (var i = 0; i < 10; ++i) { // Solve for theta numerically.
      t0 = t1;
      t1 = (Math.sin(t0) - t0 * Math.cos(t0) + 2 * k * Math.PI) / (1 - Math.cos(t0));
    }
    k = (1 - Math.cos(t1 / 2)) / 2;
  }
  return k;
}

// Update the active topic on hashchange, perhaps creating a new topic.
function hashchange() {
  var name = decodeURIComponent(location.hash.substring(1)).trim();
  updateActiveTopic(name && name != "!" ? findOrAddTopic(name) : null);
}

// Trigger a hashchange on submit.
function submit() {
  var name = this.search.value.trim();
  location.hash = name ? encodeURIComponent(name) : "!";
  this.search.value = "";
  d3.event.preventDefault();
}

// Clear the active topic when clicking on the chart background.
function clear() {
  location.replace("#!");
}

// Rather than flood the browser history, use location.replace.
function click(d) {
  location.replace("#" + encodeURIComponent(d === activeTopic ? "!" : d.name));
  // PFS: 12/05/2015
  parent.resizeIframeByHeight(parent.document.getElementsByName('iframe_a')[0],document.getElementById('interactiveABC').scrollHeight);
  d3.event.preventDefault();
}

// When hovering the label, highlight the associated node and vice versa.
// When no topic is active, also cross-highlight with any mentions in excerpts.
function mouseover(d) {
  node.classed("g-hover", function(p) { return p === d; });
  if (!activeTopic) d3.selectAll(".g-mention p").classed("g-hover", function(p) { return p.topic === d; });
}

// When hovering the label, highlight the associated node and vice versa.
// When no topic is active, also cross-highlight with any mentions in excerpts.
function mouseout(d) {
  node.classed("g-hover", false);
  if (!activeTopic) d3.selectAll(".g-mention p").classed("g-hover", false);
}

})();
